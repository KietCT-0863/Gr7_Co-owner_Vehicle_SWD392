@page
@model Co_owner_Vehicle.Pages.Groups.VotingModel
@{
    ViewData["Title"] = "Chi tiết voting";
}

<!-- Page Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-2">
                <li class="breadcrumb-item"><a asp-page="/Groups/Index">Nhóm</a></li>
                <li class="breadcrumb-item"><a asp-page="/Groups/Details">Chi tiết nhóm</a></li>
                <li class="breadcrumb-item active">Voting</li>
            </ol>
        </nav>
        <h2 class="fw-bold mb-1">
            <i class="bi bi-clipboard-check text-primary me-2"></i>Chi tiết voting
        </h2>
        <p class="text-muted mb-0">Bình chọn và quyết định nhóm</p>
    </div>
    <div class="btn-group">
        <button class="btn btn-outline-primary">
            <i class="bi bi-pencil me-2"></i>Chỉnh sửa
        </button>
        <button class="btn btn-outline-danger">
            <i class="bi bi-x-circle me-2"></i>Hủy voting
        </button>
    </div>
</div>

<!-- Voting Header Card -->
<div class="card mb-4">
    <div class="card-body">
        <div class="row g-4">
            <div class="col-md-8">
                <div class="d-flex align-items-start gap-3 mb-3">
                    <div class="bg-primary bg-opacity-10 p-3 rounded">
                        <i class="bi bi-clipboard-check fs-1 text-primary"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h4 class="fw-bold mb-2">Bình chọn thay lốp mới</h4>
                        <div class="d-flex gap-2 flex-wrap mb-2">
                            <span class="badge bg-warning fs-6">Đang bỏ phiếu</span>
                            <span class="badge bg-info">Bảo dưỡng</span>
                        </div>
                        <p class="text-muted mb-0">
                            Đề xuất thay lốp mùa hè cho xe Tesla Model 3
                        </p>
                    </div>
                </div>

                <div class="row g-3 mt-3">
                    <div class="col-md-6">
                        <label class="form-label small text-muted">Nhóm</label>
                        <p class="mb-0">
                            <i class="bi bi-people me-1"></i>Nhóm Tesla Model 3
                        </p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label small text-muted">Xe</label>
                        <p class="mb-0">
                            <i class="bi bi-car-front me-1"></i>Tesla Model 3 - 30A-12345
                        </p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label small text-muted">Người tạo</label>
                        <div class="d-flex align-items-center">
                            <div class="avatar-xs bg-primary text-white me-2">NV</div>
                            <span>Nguyễn Văn A</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label small text-muted">Ngày tạo</label>
                        <p class="mb-0">25/10/2024 10:30</p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label small text-muted">Hạn bỏ phiếu</label>
                        <p class="mb-0">
                            <i class="bi bi-calendar3 me-1"></i>30/10/2024 23:59
                        </p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label small text-muted">Thời gian còn lại</label>
                        <p class="mb-0">
                            <span class="badge bg-warning">2 ngày</span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card bg-light">
                    <div class="card-body">
                        <h6 class="mb-3">Tiến độ bỏ phiếu</h6>
                        <div class="mb-3 pb-3 border-bottom">
                            <div class="d-flex justify-content-between mb-2">
                                <span>Đã bỏ phiếu</span>
                                <strong>3/4</strong>
                            </div>
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar bg-warning" style="width: 75%">75%</div>
                            </div>
                        </div>
                        <div class="mb-3 pb-3 border-bottom">
                            <small class="text-muted">Đồng ý</small>
                            <h5 class="fw-bold mb-0">2 phiếu</h5>
                        </div>
                        <div class="mb-3 pb-3 border-bottom">
                            <small class="text-muted">Không đồng ý</small>
                            <h5 class="fw-bold mb-0">1 phiếu</h5>
                        </div>
                        <div>
                            <small class="text-muted">Chưa bỏ phiếu</small>
                            <h5 class="fw-bold mb-0 text-warning">1 người</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Left Column -->
    <div class="col-lg-8">
        <!-- Proposal Details -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="bi bi-file-text me-2"></i>Chi tiết đề xuất
                </h6>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label small text-muted">Mô tả</label>
                    <p>
                        Đề xuất thay lốp mùa hè cho xe Tesla Model 3. Lốp hiện tại đã sử dụng được 40,000 km 
                        và có dấu hiệu mòn. Việc thay lốp mới sẽ đảm bảo an toàn và hiệu suất lái xe tốt hơn.
                    </p>
                </div>
                <div class="mb-3">
                    <label class="form-label small text-muted">Lý do</label>
                    <ul>
                        <li>Lốp hiện tại đã mòn đáng kể (40,000 km)</li>
                        <li>Đảm bảo an toàn khi lái xe</li>
                        <li>Cải thiện hiệu suất và tiết kiệm nhiên liệu</li>
                    </ul>
                </div>
                <div class="mb-3">
                    <label class="form-label small text-muted">Chi phí dự kiến</label>
                    <h5 class="fw-bold text-primary mb-0">5,000,000 đ</h5>
                </div>
                <div>
                    <label class="form-label small text-muted">File đính kèm</label>
                    <div class="list-group list-group-flush">
                        <div class="list-group-item px-0">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="bg-danger bg-opacity-10 p-2 rounded me-3">
                                        <i class="bi bi-file-earmark-pdf text-danger"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">Báo giá lốp.pdf</h6>
                                        <small class="text-muted">1.2 MB</small>
                                    </div>
                                </div>
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-primary" title="Xem">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                    <button class="btn btn-outline-primary" title="Tải về">
                                        <i class="bi bi-download"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Voting Form -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="bi bi-check-circle me-2"></i>Bỏ phiếu của bạn
                </h6>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    Bạn chưa bỏ phiếu cho voting này. Vui lòng chọn phương án và nhấn "Gửi phiếu".
                </div>
                <form>
                    <div class="mb-4">
                        <label class="form-label fw-bold">Bạn có đồng ý với đề xuất này không?</label>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="vote" id="voteYes" value="yes">
                            <label class="form-check-label" for="voteYes">
                                <i class="bi bi-check-circle text-success me-1"></i>
                                <strong>Đồng ý</strong>
                                <small class="text-muted d-block ms-4">Tôi đồng ý với đề xuất này</small>
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="vote" id="voteNo" value="no">
                            <label class="form-check-label" for="voteNo">
                                <i class="bi bi-x-circle text-danger me-1"></i>
                                <strong>Không đồng ý</strong>
                                <small class="text-muted d-block ms-4">Tôi không đồng ý với đề xuất này</small>
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="vote" id="voteAbstain" value="abstain">
                            <label class="form-check-label" for="voteAbstain">
                                <i class="bi bi-dash-circle text-secondary me-1"></i>
                                <strong>Trung lập</strong>
                                <small class="text-muted d-block ms-4">Tôi không có ý kiến</small>
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ghi chú (tùy chọn)</label>
                        <textarea class="form-control" rows="3" placeholder="Bạn có thể để lại ghi chú về quyết định của mình..."></textarea>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-send me-2"></i>Gửi phiếu
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Votes List -->
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="bi bi-people me-2"></i>Kết quả bỏ phiếu
                </h6>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Thành viên</th>
                                <th>Phiếu bầu</th>
                                <th>Ghi chú</th>
                                <th>Thời gian</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-xs bg-primary text-white me-2">NV</div>
                                        Nguyễn Văn A
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Đồng ý</span></td>
                                <td>Tôi đồng ý với đề xuất này</td>
                                <td>25/10/2024 11:00</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-xs bg-success text-white me-2">LT</div>
                                        Lê Thị B
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Đồng ý</span></td>
                                <td>-</td>
                                <td>26/10/2024 09:30</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-xs bg-warning text-white me-2">TT</div>
                                        Trần Văn C
                                    </div>
                                </td>
                                <td><span class="badge bg-danger">Không đồng ý</span></td>
                                <td>Tôi nghĩ nên đợi thêm một thời gian</td>
                                <td>27/10/2024 15:20</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-xs bg-info text-white me-2">PH</div>
                                        Phạm Văn D
                                    </div>
                                </td>
                                <td><span class="badge bg-secondary">Chưa bỏ phiếu</span></td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Column -->
    <div class="col-lg-4">
        <!-- Voting Rules -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="bi bi-info-circle me-2"></i>Quy tắc voting
                </h6>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <i class="bi bi-check-circle text-success me-2"></i>
                        Mỗi thành viên có 1 phiếu
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle text-success me-2"></i>
                        Cần đa số (>50%) để thông qua
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle text-success me-2"></i>
                        Hạn bỏ phiếu: 30/10/2024
                    </li>
                    <li>
                        <i class="bi bi-check-circle text-success me-2"></i>
                        Có thể thay đổi phiếu trước hạn
                    </li>
                </ul>
            </div>
        </div>

        <!-- Voting Result Chart -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="bi bi-pie-chart me-2"></i>Kết quả
                </h6>
            </div>
            <div class="card-body">
                <canvas id="voteChart" height="200"></canvas>
                <div class="mt-3 text-center">
                    <p class="mb-1"><strong>Kết quả hiện tại:</strong></p>
                    <span class="badge bg-success fs-6">Đồng ý: 2</span>
                    <span class="badge bg-danger fs-6 ms-2">Không: 1</span>
                    <span class="badge bg-secondary fs-6 ms-2">Chưa: 1</span>
                </div>
            </div>
        </div>

        <!-- Related Votes -->
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="bi bi-link-45deg me-2"></i>Voting liên quan
                </h6>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    <a href="#" class="list-group-item list-group-item-action px-0">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="mb-1">Bình chọn đổi màu xe</h6>
                                <small class="text-muted">Đang bỏ phiếu</small>
                            </div>
                            <span class="badge bg-warning">2/4</span>
                        </div>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action px-0">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="mb-1">Bình chọn mua phụ tùng</h6>
                                <small class="text-muted">Đã kết thúc</small>
                            </div>
                            <span class="badge bg-success">Đồng ý</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Vote Chart
        const voteCtx = document.getElementById('voteChart').getContext('2d');
        new Chart(voteCtx, {
            type: 'pie',
            data: {
                labels: ['Đồng ý', 'Không đồng ý', 'Chưa bỏ phiếu'],
                datasets: [{
                    data: [2, 1, 1],
                    backgroundColor: [
                        'rgba(75, 192, 192, 0.8)',
                        'rgba(255, 99, 132, 0.8)',
                        'rgba(153, 153, 153, 0.8)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'bottom',
                    }
                }
            }
        });
    </script>
}

